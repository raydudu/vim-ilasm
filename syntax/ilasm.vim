
if version < 600
    syntax clear
elseif exists("b:current_syntax")
    finish
endif

" Case insensitive
syntax case ignore

syntax match ilasmComment "\/\/.*"
syntax match ilasmLabel "^[ \t]\+IL_[a-zA-Z0-9]\+:"
syntax match ilasmLabel2 "IL_[a-zA-Z0-9]\+$"
syntax match ilasmString /"[^"]*"/
syntax match ilasmNumber "[0-9]\+"

" The directives
" 
syntax match ilasmDirective "\.namespace"
syntax match ilasmDirective "\.method"
syntax match ilasmDirective "\.class"
syntax match ilasmDirective "\.field"
syntax match ilasmDirective "\.locals"
syntax match ilasmDirective "\.entrypoint"
syntax match ilasmDirective "\.module"
syntax match ilasmDirective "\.data"
syntax match ilasmDirective "\.size"
syntax match ilasmDirective "\.property"
syntax match ilasmDirective "\.get"
syntax match ilasmDirective "\.set"
syntax match ilasmDirective "\.other"
syntax match ilasmDirective "\.permission"
syntax match ilasmDirective "\.permissionset"
syntax match ilasmDirective "\.custom"
syntax match ilasmDirective "\.subsystem"
syntax match ilasmDirective "\.corflags"
syntax match ilasmDirective "\.file alignement"
syntax match ilasmDirective "\.imagebase"
syntax match ilasmDirective "\.line"
syntax match ilasmDirective "\.language"
syntax match ilasmDirective "\.maxstack"


" The types

syntax keyword ilasmType int8 uint8 int32 uint32 int64 float32 float64 string void int16 char bool bytearray nullref
 

" The keywords

syntax match ilasmKeyword "^[ \t]*nop" 
syntax match ilasmKeyword "^[ \t]*break" 
syntax match ilasmKeyword "^[ \t]*ldarg.0" 
syntax match ilasmKeyword "^[ \t]*ldarg.1" 
syntax match ilasmKeyword "^[ \t]*ldarg.2" 
syntax match ilasmKeyword "^[ \t]*ldarg.3"
syntax match ilasmKeyword "^[ \t]*ldloc.0"
syntax match ilasmKeyword "^[ \t]*ldloc.1"
syntax match ilasmKeyword "^[ \t]*ldloc.2"
syntax match ilasmKeyword "^[ \t]*ldloc.3"
syntax match ilasmKeyword "^[ \t]*stloc.0"
syntax match ilasmKeyword "^[ \t]*stloc.1"
syntax match ilasmKeyword "^[ \t]*stloc.2"
syntax match ilasmKeyword "^[ \t]*stloc.3"
syntax match ilasmKeyword "^[ \t]*ldarg.s"
syntax match ilasmKeyword "^[ \t]*ldarga.s"
syntax match ilasmKeyword "^[ \t]*starg.s"
syntax match ilasmKeyword "^[ \t]*ldloc.s"
syntax match ilasmKeyword "^[ \t]*ldloca.s"
syntax match ilasmKeyword "^[ \t]*stloc.s"
syntax match ilasmKeyword "^[ \t]*ldnull"
syntax match ilasmKeyword "^[ \t]*ldc.i4.m1ldc.i4.M1"
syntax match ilasmKeyword "^[ \t]*ldc.i4.0"
syntax match ilasmKeyword "^[ \t]*ldc.i4.1"
syntax match ilasmKeyword "^[ \t]*ldc.i4.2"
syntax match ilasmKeyword "^[ \t]*ldc.i4.3"
syntax match ilasmKeyword "^[ \t]*ldc.i4.4"
syntax match ilasmKeyword "^[ \t]*ldc.i4.5"
syntax match ilasmKeyword "^[ \t]*ldc.i4.6"
syntax match ilasmKeyword "^[ \t]*ldc.i4.7"
syntax match ilasmKeyword "^[ \t]*ldc.i4.8"
syntax match ilasmKeyword "^[ \t]*ldc.i4.s"
syntax match ilasmKeyword "^[ \t]*ldc.i4"
syntax match ilasmKeyword "^[ \t]*ldc.i8"
syntax match ilasmKeyword "^[ \t]*ldc.r4"
syntax match ilasmKeyword "^[ \t]*ldc.r8"
syntax match ilasmKeyword "^[ \t]*dup"
syntax match ilasmKeyword "^[ \t]*pop"
syntax match ilasmKeyword "^[ \t]*jmp"
syntax match ilasmKeyword "^[ \t]*call"
syntax match ilasmKeyword "^[ \t]*calli"
syntax match ilasmKeyword "^[ \t]*ret"
syntax match ilasmKeyword "^[ \t]*br.s"
syntax match ilasmKeyword "^[ \t]*brfalse.s"
syntax match ilasmKeyword "^[ \t]*brnull.s"
syntax match ilasmKeyword "^[ \t]*brzero.s"
syntax match ilasmKeyword "^[ \t]*brtrue.s"
syntax match ilasmKeyword "^[ \t]*brinst.s"
syntax match ilasmKeyword "^[ \t]*beq.s"
syntax match ilasmKeyword "^[ \t]*bge.s"
syntax match ilasmKeyword "^[ \t]*bgt.s"
syntax match ilasmKeyword "^[ \t]*ble.s"
syntax match ilasmKeyword "^[ \t]*blt.s"
syntax match ilasmKeyword "^[ \t]*bne.un.s"
syntax match ilasmKeyword "^[ \t]*bge.un.s"
syntax match ilasmKeyword "^[ \t]*bgt.un.s"
syntax match ilasmKeyword "^[ \t]*ble.un.s"
syntax match ilasmKeyword "^[ \t]*blt.un.s"
syntax match ilasmKeyword "^[ \t]*br"
syntax match ilasmKeyword "^[ \t]*brfalse"
syntax match ilasmKeyword "^[ \t]*brnull"
syntax match ilasmKeyword "^[ \t]*brzero"
syntax match ilasmKeyword "^[ \t]*brtrue"
syntax match ilasmKeyword "^[ \t]*brinst"
syntax match ilasmKeyword "^[ \t]*beq"
syntax match ilasmKeyword "^[ \t]*bge"
syntax match ilasmKeyword "^[ \t]*bgt"
syntax match ilasmKeyword "^[ \t]*ble"
syntax match ilasmKeyword "^[ \t]*blt"
syntax match ilasmKeyword "^[ \t]*bne.un"
syntax match ilasmKeyword "^[ \t]*bge.un"
syntax match ilasmKeyword "^[ \t]*bgt.un"
syntax match ilasmKeyword "^[ \t]*ble.un"
syntax match ilasmKeyword "^[ \t]*blt.un"
syntax match ilasmKeyword "^[ \t]*switch"
syntax match ilasmKeyword "^[ \t]*ldind.i1"
syntax match ilasmKeyword "^[ \t]*ldind.u1"
syntax match ilasmKeyword "^[ \t]*ldind.i2"
syntax match ilasmKeyword "^[ \t]*ldind.u2"
syntax match ilasmKeyword "^[ \t]*ldind.i4"
syntax match ilasmKeyword "^[ \t]*ldind.u4"
syntax match ilasmKeyword "^[ \t]*ldind.i8ldind.u8"
syntax match ilasmKeyword "^[ \t]*ldind.i"
syntax match ilasmKeyword "^[ \t]*ldind.r4"
syntax match ilasmKeyword "^[ \t]*ldind.r8"
syntax match ilasmKeyword "^[ \t]*ldind.ref"
syntax match ilasmKeyword "^[ \t]*stind.ref"
syntax match ilasmKeyword "^[ \t]*stind.i1"
syntax match ilasmKeyword "^[ \t]*stind.i2"
syntax match ilasmKeyword "^[ \t]*stind.i4"
syntax match ilasmKeyword "^[ \t]*stind.i8"
syntax match ilasmKeyword "^[ \t]*stind.r4"
syntax match ilasmKeyword "^[ \t]*stind.r8"
syntax match ilasmKeyword "^[ \t]*add"
syntax match ilasmKeyword "^[ \t]*sub"
syntax match ilasmKeyword "^[ \t]*mul"
syntax match ilasmKeyword "^[ \t]*div"
syntax match ilasmKeyword "^[ \t]*div.un"
syntax match ilasmKeyword "^[ \t]*rem"
syntax match ilasmKeyword "^[ \t]*rem.un"
syntax match ilasmKeyword "^[ \t]*and"
syntax match ilasmKeyword "^[ \t]*or"
syntax match ilasmKeyword "^[ \t]*xor"
syntax match ilasmKeyword "^[ \t]*shl"
syntax match ilasmKeyword "^[ \t]*shr"
syntax match ilasmKeyword "^[ \t]*shr.un"
syntax match ilasmKeyword "^[ \t]*neg"
syntax match ilasmKeyword "^[ \t]*not"
syntax match ilasmKeyword "^[ \t]*conv.i1"
syntax match ilasmKeyword "^[ \t]*conv.i2"
syntax match ilasmKeyword "^[ \t]*conv.i4"
syntax match ilasmKeyword "^[ \t]*conv.i8"
syntax match ilasmKeyword "^[ \t]*conv.r4"
syntax match ilasmKeyword "^[ \t]*conv.r8"
syntax match ilasmKeyword "^[ \t]*conv.u4"
syntax match ilasmKeyword "^[ \t]*conv.u8"
syntax match ilasmKeyword "^[ \t]*callvirt"
syntax match ilasmKeyword "^[ \t]*cpobj"
syntax match ilasmKeyword "^[ \t]*ldstr"
syntax match ilasmKeyword "^[ \t]*newobj"
syntax match ilasmKeyword "^[ \t]*castclass"
syntax match ilasmKeyword "^[ \t]*isinst"
syntax match ilasmKeyword "^[ \t]*conv.r.un"
syntax match ilasmKeyword "^[ \t]*unbox"
syntax match ilasmKeyword "^[ \t]*throw"
syntax match ilasmKeyword "^[ \t]*ldfld"
syntax match ilasmKeyword "^[ \t]*ldflda"
syntax match ilasmKeyword "^[ \t]*stfld"
syntax match ilasmKeyword "^[ \t]*ldsfld"
syntax match ilasmKeyword "^[ \t]*ldsflda"
syntax match ilasmKeyword "^[ \t]*stsfld"
syntax match ilasmKeyword "^[ \t]*stobj"
syntax match ilasmKeyword "^[ \t]*conv.ovf.i1.un"
syntax match ilasmKeyword "^[ \t]*conv.ovf.i2.un"
syntax match ilasmKeyword "^[ \t]*conv.ovf.i4.un"
syntax match ilasmKeyword "^[ \t]*conv.ovf.i8.un"
syntax match ilasmKeyword "^[ \t]*conv.ovf.u1.un"
syntax match ilasmKeyword "^[ \t]*conv.ovf.u2.un"
syntax match ilasmKeyword "^[ \t]*conv.ovf.u4.un"
syntax match ilasmKeyword "^[ \t]*conv.ovf.u8.un"
syntax match ilasmKeyword "^[ \t]*conv.ovf.i.un"
syntax match ilasmKeyword "^[ \t]*conv.ovf.u.un"
syntax match ilasmKeyword "^[ \t]*box"
syntax match ilasmKeyword "^[ \t]*newarr"
syntax match ilasmKeyword "^[ \t]*ldlen"
syntax match ilasmKeyword "^[ \t]*ldelema"
syntax match ilasmKeyword "^[ \t]*ldelem.i1"
syntax match ilasmKeyword "^[ \t]*ldelem.u1"
syntax match ilasmKeyword "^[ \t]*ldelem.i2"
syntax match ilasmKeyword "^[ \t]*ldelem.u2"
syntax match ilasmKeyword "^[ \t]*ldelem.i4"
syntax match ilasmKeyword "^[ \t]*ldelem.u4"
syntax match ilasmKeyword "^[ \t]*ldelem.i8ldelem.u8"
syntax match ilasmKeyword "^[ \t]*ldelem.i"
syntax match ilasmKeyword "^[ \t]*ldelem.r4"
syntax match ilasmKeyword "^[ \t]*ldelem.r8"
syntax match ilasmKeyword "^[ \t]*ldelem.ref"
syntax match ilasmKeyword "^[ \t]*stelem.i"
syntax match ilasmKeyword "^[ \t]*stelem.i1"
syntax match ilasmKeyword "^[ \t]*stelem.i2"
syntax match ilasmKeyword "^[ \t]*stelem.i4"
syntax match ilasmKeyword "^[ \t]*stelem.i8"
syntax match ilasmKeyword "^[ \t]*stelem.r4"
syntax match ilasmKeyword "^[ \t]*stelem.r8"
syntax match ilasmKeyword "^[ \t]*stelem.ref"
syntax match ilasmKeyword "^[ \t]*conv.ovf.i1"
syntax match ilasmKeyword "^[ \t]*conv.ovf.u1"
syntax match ilasmKeyword "^[ \t]*conv.ovf.i2"
syntax match ilasmKeyword "^[ \t]*conv.ovf.u2"
syntax match ilasmKeyword "^[ \t]*conv.ovf.i4"
syntax match ilasmKeyword "^[ \t]*conv.ovf.u4"
syntax match ilasmKeyword "^[ \t]*conv.ovf.i8"
syntax match ilasmKeyword "^[ \t]*conv.ovf.u8"
syntax match ilasmKeyword "^[ \t]*refanyval"
syntax match ilasmKeyword "^[ \t]*ckfinite"
syntax match ilasmKeyword "^[ \t]*mkrefany"
syntax match ilasmKeyword "^[ \t]*ldtoken"
syntax match ilasmKeyword "^[ \t]*conv.u2"
syntax match ilasmKeyword "^[ \t]*conv.u1"
syntax match ilasmKeyword "^[ \t]*conv.i"
syntax match ilasmKeyword "^[ \t]*conv.ovf.i"
syntax match ilasmKeyword "^[ \t]*conv.ovf.u"
syntax match ilasmKeyword "^[ \t]*add.ovf"
syntax match ilasmKeyword "^[ \t]*add.ovf.un"
syntax match ilasmKeyword "^[ \t]*mul.ovf"
syntax match ilasmKeyword "^[ \t]*mul.ovf.un"
syntax match ilasmKeyword "^[ \t]*sub.ovf"
syntax match ilasmKeyword "^[ \t]*sub.ovf.un"
syntax match ilasmKeyword "^[ \t]*endfinallyendfault"
syntax match ilasmKeyword "^[ \t]*leave"
syntax match ilasmKeyword "^[ \t]*leave.s"
syntax match ilasmKeyword "^[ \t]*stind.i"
syntax match ilasmKeyword "^[ \t]*conv.u"
syntax match ilasmKeyword "^[ \t]*arglist"
syntax match ilasmKeyword "^[ \t]*ceq"
syntax match ilasmKeyword "^[ \t]*cgt"
syntax match ilasmKeyword "^[ \t]*cgt.un"
syntax match ilasmKeyword "^[ \t]*clt"
syntax match ilasmKeyword "^[ \t]*clt.un"
syntax match ilasmKeyword "^[ \t]*ldftn"
syntax match ilasmKeyword "^[ \t]*ldvirtftn"
syntax match ilasmKeyword "^[ \t]*ldarg"
syntax match ilasmKeyword "^[ \t]*ldarga"
syntax match ilasmKeyword "^[ \t]*starg"
syntax match ilasmKeyword "^[ \t]*ldloc"
syntax match ilasmKeyword "^[ \t]*ldloca"
syntax match ilasmKeyword "^[ \t]*stloc"
syntax match ilasmKeyword "^[ \t]*localloc"
syntax match ilasmKeyword "^[ \t]*endfilter"
syntax match ilasmKeyword "^[ \t]*unaligned."
syntax match ilasmKeyword "^[ \t]*volatile."
syntax match ilasmKeyword "^[ \t]*tail."
syntax match ilasmKeyword "^[ \t]*initobj"
syntax match ilasmKeyword "^[ \t]*cpblk"
syntax match ilasmKeyword "^[ \t]*initblk"
syntax match ilasmKeyword "^[ \t]*rethrow"
syntax match ilasmKeyword "^[ \t]*sizeof"
syntax match ilasmKeyword "^[ \t]*refanytype"

syntax keyword ilasmDeclaration public private privatescope family assembly famandassem famorassem cil cdecl  stdcall thiscall fastcall managed unmanaged auto ansi extends static valuetype explicit init vararg extern at initonly rtspecialname marchal literal notserialized specialname request demand assert deny permitonly linkcheck inheritcheck reqmin reqopt reqrefuse prejitgrant noncasdemand noncaslinkdemand noncasinheritance fromunmanaged callmostderived unicode value enum interface sealed abstract sequential autochar import serializable beforefieldinit nested

if !exists("did_ilasm_syntax_inits")
   	let did_ilasm_syntax_inits=1
	highlight link ilasmComment Comment
	highlight link ilasmLabel2 Exception
	highlight link ilasmLabel Exception
	highlight link ilasmString String
	highlight link ilasmNumber Number
	highlight link ilasmType Type

	highlight link ilasmDirective Preproc
	highlight link ilasmDeclaration Preproc

	highlight link ilasmKeyword Keyword 

endif
let b:current_syntax="ilasm"



